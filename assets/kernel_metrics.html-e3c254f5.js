import{_ as t,X as e,Y as l,a3 as d}from"./framework-a5f096d1.js";const a={},s=d(`<p>本章节内容主要介绍openGemini自带的Kernel监控指标项，如果使用ts-monitor采集内核指标，会额外采集节点的内存利用率、cpu利用率、进程状态信息等，见<a href="#system-%E8%8A%82%E7%82%B9%E6%8C%87%E6%A0%87">system</a>。</p><p>一般建议用户关注如下数据表内的指标项：</p><ul><li>Cluster_metric</li><li>Httpd</li><li>IO</li><li>Measurement_metric</li><li>RunTime</li><li>System</li></ul><p>建议内核开发者或在对openGemini非常熟悉的核心用户可以关注其他表内容，可以通过指标窥探到openGemini实际运行情况，帮助理解和性能参数优化。比如Record表，统计了内存池的使用情况，如果出现大量大内存申请的情况，可以适当考虑将内存池空间调大。</p><h2 id="grafana看板查询语句示例" tabindex="-1"><a class="header-anchor" href="#grafana看板查询语句示例" aria-hidden="true">#</a> Grafana看板查询语句示例</h2><h3 id="cpu利用率" tabindex="-1"><a class="header-anchor" href="#cpu利用率" aria-hidden="true">#</a> CPU利用率</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT sum(&quot;usage&quot;)/count(&quot;usage&quot;) FROM (SELECT last(&quot;usage&quot;) as &quot;usage&quot; FROM (SELECT mean(&quot;CpuUsage&quot;) as &quot;usage&quot; FROM system WHERE time &lt; xxx AND time &gt; xxx GROUP BY time(1m),&quot;host&quot; FILL(null)) GROUP BY &quot;host&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="内存利用率" tabindex="-1"><a class="header-anchor" href="#内存利用率" aria-hidden="true">#</a> 内存利用率</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT sum(&quot;use&quot;)/sum(&quot;total&quot;) FROM (SELECT last(&quot;MemInUse&quot;) as &quot;use&quot;, last(&quot;MemSize&quot;) as &quot;total&quot; FROM system WHERE time &lt; xxx AND time &gt; xxx GROUP BY &quot;host&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="磁盘平均使用率" tabindex="-1"><a class="header-anchor" href="#磁盘平均使用率" aria-hidden="true">#</a> 磁盘平均使用率</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT sum(&quot;use&quot;)/sum(&quot;total&quot;) FROM (SELECT last(&quot;DiskUsed&quot;) as &quot;use&quot;, last(&quot;DiskSize&quot;) as &quot;total&quot; FROM system WHERE time &lt; xxx AND time &gt; xxx GROUP BY &quot;host&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="集群写流量趋势-万metrics-s" tabindex="-1"><a class="header-anchor" href="#集群写流量趋势-万metrics-s" aria-hidden="true">#</a> 集群写流量趋势（万metrics/s)</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;write&quot;)/1000/60 as cluster_write_qps FROM (SELECT sum(&quot;write&quot;) as &quot;write&quot; FROM (SELECT last(&quot;fieldsWritten&quot;) AS &quot;write&quot; FROM httpd WHERE time &gt; xxx AND time &lt; xxx GROUP BY time(1m),* FILL(linear)) GROUP BY time(1m) FILL(linear) LIMIT 718 offset 1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="每个ts-sql的写带宽-mb-s" tabindex="-1"><a class="header-anchor" href="#每个ts-sql的写带宽-mb-s" aria-hidden="true">#</a> 每个TS-SQL的写带宽(MB/s)</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;writeReqBytes&quot;)/1024/1024/10 AS &quot;mean_writeReqBytes&quot; FROM httpd WHERE time &gt; xxx AND time &lt; xxx GROUP BY hostname
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里<code>difference(&quot;writeReqBytes&quot;)/1024/1024/10</code>,采样周期时10s，最后除以10是计算每秒的数据</p><h3 id="每个ts-sql的写时延-ns" tabindex="-1"><a class="header-anchor" href="#每个ts-sql的写时延-ns" aria-hidden="true">#</a> 每个TS-SQL的写时延(ns)</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;writeReqDurationNs&quot;)/difference(&quot;writeReq&quot;) AS &quot;Duration&quot; FROM httpd WHERE time &gt; xxx AND time &lt; xxx GROUP BY &quot;hostname&quot; FILL(null)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="每个ts-store的写时延-ns" tabindex="-1"><a class="header-anchor" href="#每个ts-store的写时延-ns" aria-hidden="true">#</a> 每个TS-STORE的写时延(ns)</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;writeStorageDurationNs&quot;)/difference(&quot;WriteRowsBatch&quot;) AS &quot;Duration&quot; FROM performance WHERE time &gt; xxx AND time &lt; xxx GROUP BY &quot;hostname&quot; FILL(null)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="每个ts-sql的写qps" tabindex="-1"><a class="header-anchor" href="#每个ts-sql的写qps" aria-hidden="true">#</a> 每个TS-SQL的写QPS</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;pointsWrittenOK&quot;)/10 FROM httpd WHERE time &gt; xxx AND time &lt; xxx GROUP BY &quot;hostname&quot; FILL(null)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>采样周期时10s，最后除以10是计算每秒的数据</p><h3 id="集群的查询qps" tabindex="-1"><a class="header-anchor" href="#集群的查询qps" aria-hidden="true">#</a> 集群的查询QPS</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;qr&quot;)/10 AS &quot;QPS&quot; FROM (SELECT sum(queryReq) AS &quot;qr&quot; FROM httpd WHERE time &gt; xxx AND time &lt; xxx GROUP BY time(10s))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>采样周期时10s，最后除以10是计算每秒的数据</p><h3 id="集群的查询时延" tabindex="-1"><a class="header-anchor" href="#集群的查询时延" aria-hidden="true">#</a> 集群的查询时延</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT difference(&quot;duration&quot;)/difference(&quot;qr&quot;)/1000000 AS &quot;latency&quot; FROM (SELECT sum(queryReqDurationNs) AS &quot;duration&quot;, sum(queryReq) AS &quot;qr&quot; FROM httpd WHERE time &gt; xxx AND time &lt; xxx GROUP BY time(2m))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="磁盘写时延" tabindex="-1"><a class="header-anchor" href="#磁盘写时延" aria-hidden="true">#</a> 磁盘写时延</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT mean(writeDuration)/mean(writeOkCount) FROM io WHERE time &gt; xxx AND time &lt; xxx GROUP BY(10s), hostname
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="cluster-metric" tabindex="-1"><a class="header-anchor" href="#cluster-metric" aria-hidden="true">#</a> Cluster_metric</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th>数据类型</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:left;">DBCount</td><td>float</td><td>集群中创建的DB总数</td></tr><tr><td style="text-align:left;">MstCount</td><td>float</td><td>集群中所所有DB中表的总数</td></tr></tbody></table><h2 id="compact-lsm-tree文件合并相关指标" tabindex="-1"><a class="header-anchor" href="#compact-lsm-tree文件合并相关指标" aria-hidden="true">#</a> Compact(LSM-Tree文件合并相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th>数据类型</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:left;">Action</td><td>string</td><td>level/full,表示“level compact“ 还是 “full compact&quot;</td></tr><tr><td style="text-align:left;">App</td><td>string</td><td>组件名</td></tr><tr><td style="text-align:left;">hostname</td><td>组件Ip地址和端口</td><td></td></tr><tr><td style="text-align:left;">level</td><td>表示Compact发生的level，分[0-7]</td><td></td></tr><tr><td style="text-align:left;">measurement</td><td>Compact发生的表</td><td></td></tr><tr><td style="text-align:left;">shard_id</td><td>Compact发生的shard</td><td></td></tr><tr><td style="text-align:left;">Active</td><td>float</td><td>当前运行的Compact任务数量</td></tr><tr><td style="text-align:left;">CompactedFileCount</td><td>float</td><td>单次任务，Compact后的文件数量</td></tr><tr><td style="text-align:left;">CompactedFileSize</td><td>float</td><td>单次任务，Compact后的文件总大小</td></tr><tr><td style="text-align:left;">Duration</td><td>float</td><td>单次Compact任务耗时</td></tr><tr><td style="text-align:left;">Errors</td><td>float</td><td>Compact错误次数</td></tr><tr><td style="text-align:left;">MaxMemoryUsed</td><td>float</td><td>Compact最大内存消耗</td></tr><tr><td style="text-align:left;">OriginalFileCount</td><td>float</td><td>单次任务，Compact的源文件数量</td></tr><tr><td style="text-align:left;">OriginalFileSize</td><td>float</td><td>单次任务，Compact的源文件总大小</td></tr><tr><td style="text-align:left;">Ratio</td><td>float</td><td>单次任务，Compact的压缩率</td></tr><tr><td style="text-align:left;">RecordPoolGetTotal</td><td>float</td><td>统计内存池分配Record对象的频次</td></tr><tr><td style="text-align:left;">RecordPoolHitTotal</td><td>float</td><td>Record对象池累计命中次数，用于衡量内存复用效果)</td></tr></tbody></table><h2 id="downsample-多级将采样相关指标" tabindex="-1"><a class="header-anchor" href="#downsample-多级将采样相关指标" aria-hidden="true">#</a> DownSample(多级将采样相关指标）</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">Active</td><td style="text-align:left;">float</td><td style="text-align:left;">当前运行的将采样任务数量</td></tr><tr><td style="text-align:left;">Errors</td><td style="text-align:left;">float</td><td style="text-align:left;">将采样任务运行过程中产生的错误数量</td></tr></tbody></table><h2 id="engine-存储引擎相关指标" tabindex="-1"><a class="header-anchor" href="#engine-存储引擎相关指标" aria-hidden="true">#</a> Engine(存储引擎相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">CloseDurations</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎关闭耗时</td></tr><tr><td style="text-align:left;">CloseErrors</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎关闭过程出现错误的次数</td></tr><tr><td style="text-align:left;">DelIndexCount</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除索引的总次数</td></tr><tr><td style="text-align:left;">DelIndexDuration</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除索引的总耗时</td></tr><tr><td style="text-align:left;">DelIndexErr</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除索引过程出现错误的次数</td></tr><tr><td style="text-align:left;">DelShardCount</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除Shard的总次数</td></tr><tr><td style="text-align:left;">DelShardDuration</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除Shard的总耗时</td></tr><tr><td style="text-align:left;">DelShardErr</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除Shard过程出现错误的次数</td></tr><tr><td style="text-align:left;">DropDatabaseCount</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除DB的总次数</td></tr><tr><td style="text-align:left;">DropDatabaseDurations</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除DB的总耗时</td></tr><tr><td style="text-align:left;">DropDatabaseErrs</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除DB过程出现错误的总次数</td></tr><tr><td style="text-align:left;">DropMstCount</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除表的总次数</td></tr><tr><td style="text-align:left;">DropMstDurations</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除表的总耗时</td></tr><tr><td style="text-align:left;">DropMstErrs</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除表过程出现错误的总次数</td></tr><tr><td style="text-align:left;">DropRPCount</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除RP的总次数</td></tr><tr><td style="text-align:left;">DropRPDurations</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除RP的总耗时</td></tr><tr><td style="text-align:left;">DropRPErrs</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎删除RP过程出现错误的总次数</td></tr><tr><td style="text-align:left;">OpenDurations</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎启动的总耗时</td></tr><tr><td style="text-align:left;">OpenErrors</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎启动过程中出现的错误次数</td></tr></tbody></table><h2 id="errno-错误信息" tabindex="-1"><a class="header-anchor" href="#errno-错误信息" aria-hidden="true">#</a> Errno(错误信息)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">errno</td><td style="text-align:left;">string</td><td style="text-align:left;">错误码</td></tr><tr><td style="text-align:left;">module</td><td style="text-align:left;">string</td><td style="text-align:left;">功能模块编码</td></tr><tr><td style="text-align:left;">value</td><td style="text-align:left;">float</td><td style="text-align:left;">错误次数</td></tr></tbody></table><h2 id="executor-查询引擎相关指标" tabindex="-1"><a class="header-anchor" href="#executor-查询引擎相关指标" aria-hidden="true">#</a> Executor(查询引擎相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">agg_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">agg_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">agg_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">column_length_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">column_length_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">column_length_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">column_width_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">column_width_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">column_width_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">dag_edge_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">dag_edge_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">dag_edge_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">dag_vertex_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">dag_vertex_lsat</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">dag_vertex_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">exec_abort_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器被终止的总次数</td></tr><tr><td style="text-align:left;">exec_abort_last</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_abort_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_failed_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器执行失败的总次数</td></tr><tr><td style="text-align:left;">exec_failed_last</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_failed_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_run_time_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器执行总次数</td></tr><tr><td style="text-align:left;">exec_run_time_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次执行时延</td></tr><tr><td style="text-align:left;">exec_run_time_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器执行总时长</td></tr><tr><td style="text-align:left;">exec_scheduled_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器调度总次数</td></tr><tr><td style="text-align:left;">exec_scheduled_last</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_scheduled_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_timeout_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器超时总次数</td></tr><tr><td style="text-align:left;">exec_timeout_last</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_timeout_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，忽略</td></tr><tr><td style="text-align:left;">exec_wait_time_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器申请内存资源总次数</td></tr><tr><td style="text-align:left;">exec_wait_time_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次申请内存资源的等待时延(ns)</td></tr><tr><td style="text-align:left;">exec_wait_time_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器申请内存资源是总时延(ns)</td></tr><tr><td style="text-align:left;">fill_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">fill_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">fill_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">filter_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">filter_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">filter_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">goroutine_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器执行总次数</td></tr><tr><td style="text-align:left;">goroutine_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次查询计划执行时分配的goroutine数量</td></tr><tr><td style="text-align:left;">goroutine_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">总的goroutine数量</td></tr><tr><td style="text-align:left;">limit_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">limit_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">limit_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">materialized_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">materialized_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">materialized_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">memory_count</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器执行总次数</td></tr><tr><td style="text-align:left;">memory_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次查询计划执行时使用内存大小</td></tr><tr><td style="text-align:left;">memory_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">查询计划的执行器累计使用内存大小</td></tr><tr><td style="text-align:left;">merge_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">merge_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">merge_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">sink_length_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">sink_length_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">sink_length_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">sink_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">总次数</td></tr><tr><td style="text-align:left;">sink_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次执行器执行时出口数据行数</td></tr><tr><td style="text-align:left;">sink_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">执行器执行时出口数据总行数</td></tr><tr><td style="text-align:left;">sink_width_count</td><td style="text-align:left;">float</td><td style="text-align:left;">总次数</td></tr><tr><td style="text-align:left;">sink_width_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次执行器执行时出口数据列宽</td></tr><tr><td style="text-align:left;">sink_width_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">执行器执行时出口数据总列宽</td></tr><tr><td style="text-align:left;">source_length_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">source_length_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">source_length_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">source_rows_count</td><td style="text-align:left;">float</td><td style="text-align:left;">总次数</td></tr><tr><td style="text-align:left;">source_rows_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次执行器执行时入口数据行数</td></tr><tr><td style="text-align:left;">source_rows_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">执行器执行时入口数据总行数</td></tr><tr><td style="text-align:left;">source_width_count</td><td style="text-align:left;">float</td><td style="text-align:left;">总次数</td></tr><tr><td style="text-align:left;">source_width_last</td><td style="text-align:left;">float</td><td style="text-align:left;">最近一次执行器执行时入口数据列宽</td></tr><tr><td style="text-align:left;">source_width_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">执行器执行时入口数据总列宽</td></tr><tr><td style="text-align:left;">trans_abort_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_abort_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_abort_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_failed_abort_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_failed_abort_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_failed_abort_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_failed_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_failed_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_failed_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_run_time_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_run_time_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_run_time_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_wait_time_count</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_wait_time_last</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">trans_wait_time_sum</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr></tbody></table><h2 id="filestat-存储文件信息" tabindex="-1"><a class="header-anchor" href="#filestat-存储文件信息" aria-hidden="true">#</a> FileStat(存储文件信息)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">database</td><td style="text-align:left;">string</td><td style="text-align:left;">数据库名</td></tr><tr><td style="text-align:left;">id</td><td style="text-align:left;">string</td><td style="text-align:left;">？？</td></tr><tr><td style="text-align:left;">measurement</td><td style="text-align:left;">string</td><td style="text-align:left;">表名称</td></tr><tr><td style="text-align:left;">path</td><td style="text-align:left;">string</td><td style="text-align:left;">数据文件路径</td></tr><tr><td style="text-align:left;">retentionPolicy</td><td style="text-align:left;">string</td><td style="text-align:left;">数据库对应的数据保留策略名称</td></tr><tr><td style="text-align:left;">FileCount</td><td style="text-align:left;">float</td><td style="text-align:left;">表的数据文件数量</td></tr><tr><td style="text-align:left;">FileSize</td><td style="text-align:left;">float</td><td style="text-align:left;">表的数据文件大小</td></tr></tbody></table><h2 id="filestat-level-存储文件信息-按compact-level维度统计" tabindex="-1"><a class="header-anchor" href="#filestat-level-存储文件信息-按compact-level维度统计" aria-hidden="true">#</a> FileStat_Level(存储文件信息,按Compact Level维度统计)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">database</td><td style="text-align:left;">string</td><td style="text-align:left;">数据库名</td></tr><tr><td style="text-align:left;">level</td><td style="text-align:left;">string</td><td style="text-align:left;">数据文件Level</td></tr><tr><td style="text-align:left;">FileCount</td><td style="text-align:left;">float</td><td style="text-align:left;">数据库中，当前Level的数据文件总数</td></tr><tr><td style="text-align:left;">FileSize</td><td style="text-align:left;">float</td><td style="text-align:left;">数据库中，当前Level的数据文件总大小</td></tr></tbody></table><h2 id="httpd-对外相关统计信息" tabindex="-1"><a class="header-anchor" href="#httpd-对外相关统计信息" aria-hidden="true">#</a> Httpd(对外相关统计信息)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">WriteMapRowsDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">WriteStreamRoutineDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">WriteUpdateIndexDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">authFail</td><td style="text-align:left;">float</td><td style="text-align:left;">用户认证失败次数</td></tr><tr><td style="text-align:left;">clientError</td><td style="text-align:left;">float</td><td style="text-align:left;">服务器返回4xx错误次数</td></tr><tr><td style="text-align:left;">connectionNum</td><td style="text-align:left;">float</td><td style="text-align:left;">客户端连接数量</td></tr><tr><td style="text-align:left;">fieldsWritten</td><td style="text-align:left;">float</td><td style="text-align:left;">写入的field列数</td></tr><tr><td style="text-align:left;">pingReq</td><td style="text-align:left;">float</td><td style="text-align:left;">收到的ping请求数</td></tr><tr><td style="text-align:left;">pointsWrittenDropped</td><td style="text-align:left;">float</td><td style="text-align:left;">批量写入时，部分写失败的数据总条数</td></tr><tr><td style="text-align:left;">pointsWrittenFail</td><td style="text-align:left;">float</td><td style="text-align:left;">写失败的数据条数(全部失败)</td></tr><tr><td style="text-align:left;">pointsWrittenOK</td><td style="text-align:left;">float</td><td style="text-align:left;">写成功的数据条数</td></tr><tr><td style="text-align:left;">query400ErrorStmtCount</td><td style="text-align:left;">float</td><td style="text-align:left;">查询时，服务器400错误的次数</td></tr><tr><td style="text-align:left;">queryErrorStmtCount</td><td style="text-align:left;">float</td><td style="text-align:left;">查询失败的查询语句数量</td></tr><tr><td style="text-align:left;">queryReq</td><td style="text-align:left;">float</td><td style="text-align:left;">接收到客户端查询请求数量</td></tr><tr><td style="text-align:left;">queryReqActive</td><td style="text-align:left;">float</td><td style="text-align:left;">当前活跃的查询请求数量</td></tr><tr><td style="text-align:left;">queryReqDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">累计查询时延(ns)</td></tr><tr><td style="text-align:left;">queryRespBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">查询返回的数据总量(按Byte计算)</td></tr><tr><td style="text-align:left;">queryStmtCount</td><td style="text-align:left;">float</td><td style="text-align:left;">查询语句总数</td></tr><tr><td style="text-align:left;">recoveredPanics</td><td style="text-align:left;">float</td><td style="text-align:left;">处理程序Panic的总次数</td></tr><tr><td style="text-align:left;">req</td><td style="text-align:left;">float</td><td style="text-align:left;">累计接收客户端请求数（含读和写）</td></tr><tr><td style="text-align:left;">reqActive</td><td style="text-align:left;">float</td><td style="text-align:left;">当前活跃请求数</td></tr><tr><td style="text-align:left;">reqDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">所有请求的累计响应时延(ns)</td></tr><tr><td style="text-align:left;">scheduleUnmarshalDns</td><td style="text-align:left;">float</td><td style="text-align:left;">数据反序列化累计耗时</td></tr><tr><td style="text-align:left;">serverError</td><td style="text-align:left;">float</td><td style="text-align:left;">服务器返回5xx错误累计次数</td></tr><tr><td style="text-align:left;">statusReq</td><td style="text-align:left;">float</td><td style="text-align:left;">&#39;/status&#39;接口接收到的请求数</td></tr><tr><td style="text-align:left;">write400ErrReq</td><td style="text-align:left;">float</td><td style="text-align:left;">找不到数据库、权限不足等问题导致的错误累计次数</td></tr><tr><td style="text-align:left;">write500ErrReq</td><td style="text-align:left;">float</td><td style="text-align:left;">写数据出现服务器内部错误的累计次数</td></tr><tr><td style="text-align:left;">writeCreateMstDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">写时创表过程的时延(ns)</td></tr><tr><td style="text-align:left;">writeCreateSgDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">写时创建ShardGroup过程的时延</td></tr><tr><td style="text-align:left;">writeReq</td><td style="text-align:left;">float</td><td style="text-align:left;">服务器接收到写请求累计次数</td></tr><tr><td style="text-align:left;">writeReqActive</td><td style="text-align:left;">float</td><td style="text-align:left;">当前活跃的写请求数量</td></tr><tr><td style="text-align:left;">writeReqDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">写数据累计时延(ns)</td></tr><tr><td style="text-align:left;">writeReqBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">写入成功的总数据量(按Byte计算)</td></tr><tr><td style="text-align:left;">writeReqBytesIn</td><td style="text-align:left;">float</td><td style="text-align:left;">总的写数据量(含写失败和写成功)</td></tr><tr><td style="text-align:left;">writeReqParseDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">解析写入数据格式的累计时延</td></tr><tr><td style="text-align:left;">writeStoresDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">数据写存储引擎的累计时延</td></tr><tr><td style="text-align:left;">writeUnmarshalSkDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">writeUpdateSchemaDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">更新表元数据(如新增Field)过程产生的累计时延(ns)</td></tr></tbody></table><h2 id="io" tabindex="-1"><a class="header-anchor" href="#io" aria-hidden="true">#</a> IO</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">readActiveBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">readActiveCount</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">readCacheCount</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">readCacheMem</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎读文件时使用的block cache大小</td></tr><tr><td style="text-align:left;">readCacheRatio</td><td style="text-align:left;">float</td><td style="text-align:left;">block cache命中率</td></tr><tr><td style="text-align:left;">readDuration</td><td style="text-align:left;">float</td><td style="text-align:left;">读文件的IO累计时延</td></tr><tr><td style="text-align:left;">readOkBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">读文件IO成功读取的累计数据量(按Byte计算)</td></tr><tr><td style="text-align:left;">readOkCount</td><td style="text-align:left;">float</td><td style="text-align:left;">读文件IO成功的次数</td></tr><tr><td style="text-align:left;">readTotalBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">读IO总的数据量(按Byte计算)</td></tr><tr><td style="text-align:left;">readTotalCount</td><td style="text-align:left;">float</td><td style="text-align:left;">读IO总的次数</td></tr><tr><td style="text-align:left;">snapshotSize</td><td style="text-align:left;">float</td><td style="text-align:left;">快照文件大小(累计,按Byte计算)</td></tr><tr><td style="text-align:left;">snapshotCount</td><td style="text-align:left;">float</td><td style="text-align:left;">快照次数</td></tr><tr><td style="text-align:left;">syncActiveCount</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">syncDuration</td><td style="text-align:left;">float</td><td style="text-align:left;">累计刷盘File.Sync()时延(ns)</td></tr><tr><td style="text-align:left;">syncOKCount</td><td style="text-align:left;">float</td><td style="text-align:left;">成功刷盘的次数</td></tr><tr><td style="text-align:left;">syncTotalCount</td><td style="text-align:left;">float</td><td style="text-align:left;">总的刷盘次数</td></tr><tr><td style="text-align:left;">writeActiveBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">writeActiveCount</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">writeDuration</td><td style="text-align:left;">float</td><td style="text-align:left;">累计写IO时延(File.Write())</td></tr><tr><td style="text-align:left;">writeOkBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">写文件IO成功写入的累计数据量(按Byte计算)</td></tr><tr><td style="text-align:left;">writeOkCount</td><td style="text-align:left;">float</td><td style="text-align:left;">写IO次数</td></tr><tr><td style="text-align:left;">writeTotalBytes</td><td style="text-align:left;">float</td><td style="text-align:left;">写IO总数据量(按Byte计算)</td></tr><tr><td style="text-align:left;">writeTotalCount</td><td style="text-align:left;">float</td><td style="text-align:left;">写IO总次数</td></tr></tbody></table><h2 id="measurement-metric" tabindex="-1"><a class="header-anchor" href="#measurement-metric" aria-hidden="true">#</a> Measurement_metric</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">database</td><td style="text-align:left;">string</td><td style="text-align:left;">数据库名</td></tr><tr><td style="text-align:left;">measurement</td><td style="text-align:left;">string</td><td style="text-align:left;">表名</td></tr><tr><td style="text-align:left;">seriesCount</td><td style="text-align:left;">float</td><td style="text-align:left;">时间线数量</td></tr></tbody></table><h2 id="merge-文件合并相关指标" tabindex="-1"><a class="header-anchor" href="#merge-文件合并相关指标" aria-hidden="true">#</a> Merge(文件合并相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">Measurement</td><td style="text-align:left;">string</td><td style="text-align:left;">表名</td></tr><tr><td style="text-align:left;">ShardId</td><td style="text-align:left;">string</td><td style="text-align:left;">分片ID</td></tr><tr><td style="text-align:left;">Active</td><td style="text-align:left;">float</td><td style="text-align:left;">当前运行中的乱序数据合并任务数</td></tr><tr><td style="text-align:left;">CurrentOutOfOrderFile</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">Duration</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">Errors</td><td style="text-align:left;">float</td><td style="text-align:left;">乱序合并时出现错误累计次数</td></tr><tr><td style="text-align:left;">MergeFileCount</td><td style="text-align:left;">float</td><td style="text-align:left;">单次任务，乱序合并后的文件总数</td></tr><tr><td style="text-align:left;">MergeFileSize</td><td style="text-align:left;">float</td><td style="text-align:left;">单次任务，乱序合并后的文件总大小</td></tr><tr><td style="text-align:left;">OrderFileCount</td><td style="text-align:left;">float</td><td style="text-align:left;">单次任务，有序文件总数</td></tr><tr><td style="text-align:left;">OrderFileSize</td><td style="text-align:left;">float</td><td style="text-align:left;">单次任务，有序文件总大小</td></tr><tr><td style="text-align:left;">SkipTotal</td><td style="text-align:left;">float</td><td style="text-align:left;">单次任务，不满足乱序合并条件，跳过合并的次数</td></tr></tbody></table><h2 id="meta-元数据管理相关指标" tabindex="-1"><a class="header-anchor" href="#meta-元数据管理相关指标" aria-hidden="true">#</a> Meta(元数据管理相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">Host</td><td style="text-align:left;">string</td><td style="text-align:left;">store节点地址</td></tr><tr><td style="text-align:left;">NodeID</td><td style="text-align:left;">string</td><td style="text-align:left;">store节点ID</td></tr><tr><td style="text-align:left;">LTime</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-meta管理的ts-store用的逻辑时钟，确保seriesID递增</td></tr><tr><td style="text-align:left;">LeaderSwitchTotal</td><td style="text-align:left;">float</td><td style="text-align:left;">leader节点故障导致切主的累计次数</td></tr><tr><td style="text-align:left;">SnapshotDataSize</td><td style="text-align:left;">float</td><td style="text-align:left;">将当前系统状态(如节点信息等)写入快照的数据大小</td></tr><tr><td style="text-align:left;">SnapshotTotal</td><td style="text-align:left;">float</td><td style="text-align:left;">保存系统状态的次数(通过快照保存）</td></tr><tr><td style="text-align:left;">SnapshotUnmarshalDuration</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-sql获取meta全量元数据时，meta向sql回复的快照数据反序列化时延(ns)</td></tr><tr><td style="text-align:left;">Status</td><td style="text-align:left;">float</td><td style="text-align:left;">meta节点状态，1(健康), 4(故障)</td></tr><tr><td style="text-align:left;">storeApplyTotal</td><td style="text-align:left;">float</td><td style="text-align:left;">集群管理类、DDL类命令需要在ts-meta上创建元数据，会调用Apply()方法存储数据，这里统计总次数</td></tr></tbody></table><h2 id="metaraft-ts-meta上raft相关指标" tabindex="-1"><a class="header-anchor" href="#metaraft-ts-meta上raft相关指标" aria-hidden="true">#</a> MetaRaft(ts-meta上Raft相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">NodeID</td><td style="text-align:left;">string</td><td style="text-align:left;">ts-meta节点ID</td></tr><tr><td style="text-align:left;">Status</td><td style="text-align:left;">float</td><td style="text-align:left;">节点角色，0(follower), 1(cadidate), 2(leader)</td></tr><tr><td style="text-align:left;">foo</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，后期版本将删除</td></tr></tbody></table><h2 id="metadata-故障接管相关指标-共享存储支持" tabindex="-1"><a class="header-anchor" href="#metadata-故障接管相关指标-共享存储支持" aria-hidden="true">#</a> metadata(故障接管相关指标，共享存储支持）</h2><h2 id="performance-存储数据时的各项指标" tabindex="-1"><a class="header-anchor" href="#performance-存储数据时的各项指标" aria-hidden="true">#</a> performance(存储数据时的各项指标）</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">FlushOrderRowsCount</td><td style="text-align:left;">float</td><td style="text-align:left;">下盘的有序数据总行数</td></tr><tr><td style="text-align:left;">FlushRowsCount</td><td style="text-align:left;">float</td><td style="text-align:left;">下盘的数据总行数(含有序和乱序)</td></tr><tr><td style="text-align:left;">FlushSnapshotCount</td><td style="text-align:left;">float</td><td style="text-align:left;">存储引擎缓存数据刷盘次数</td></tr><tr><td style="text-align:left;">FlushSnapshotDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">缓存刷盘的累计时延(ns)，包括申请资源、缓存数据排序、刷盘、资源释放、删除WAL日志等过程</td></tr><tr><td style="text-align:left;">FlushUnOrderRowsCount</td><td style="text-align:left;">float</td><td style="text-align:left;">下盘的乱序数据总行数</td></tr><tr><td style="text-align:left;">SnapshotFlushChunksNs</td><td style="text-align:left;">float</td><td style="text-align:left;">特指FlushChunks方法刷盘的累计时延(ns)</td></tr><tr><td style="text-align:left;">SnapshotHandleChunksNs</td><td style="text-align:left;">float</td><td style="text-align:left;">无意义，后期版本将删除</td></tr><tr><td style="text-align:left;">SnapshotSortChunksNs</td><td style="text-align:left;">float</td><td style="text-align:left;">特指刷盘前排序过程的累计时延(ns)</td></tr><tr><td style="text-align:left;">WriteActiveRequests</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上, 当前正在写入的任务数</td></tr><tr><td style="text-align:left;">WriteAddSidRowCountNs</td><td style="text-align:left;">float</td><td style="text-align:left;">暂未启用</td></tr><tr><td style="text-align:left;">WriteCreateShardNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，创建新的分片(shard)累计时延(ns)</td></tr><tr><td style="text-align:left;">WriteFieldsCount</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，写入的指标列(Field)的总数</td></tr><tr><td style="text-align:left;">WriteGetMstInfoNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-sotre节点上，写入数据时查询表信息的累计时延</td></tr><tr><td style="text-align:left;">WriteGetTokenDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-sotre节点上，写入数据时，流控逻辑中等待资源分配的累计时延(ns)</td></tr><tr><td style="text-align:left;">WriteIndexDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，写入数据时创建索引的累计时延(ns)</td></tr><tr><td style="text-align:left;">WriteMstInfoNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，写入缓存的累计时延(特指在write_rows方法中的写时延)</td></tr><tr><td style="text-align:left;">WriteReqErrors</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，写数据出错的总次数</td></tr><tr><td style="text-align:left;">WriteRowsBatch</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，批量写入的次数，衡量数据写入频次</td></tr><tr><td style="text-align:left;">WriteRowsCount</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，数据写入总的行数</td></tr><tr><td style="text-align:left;">WriteRowsDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，写入缓存的累计时延(粒度比WriteMstInfoNs更粗)</td></tr><tr><td style="text-align:left;">WriteShardKeyIdxNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，创建ShardKeyIndex的总时延</td></tr><tr><td style="text-align:left;">WriteSortIndexDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，写索引数据之前索引数据排序的总时延(ns)</td></tr><tr><td style="text-align:left;">WriteStorageDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点上，整个写入流程的总时延</td></tr><tr><td style="text-align:left;">WriteUnmarshalNs</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store节点接收到数据后，反序列化所需时延(累计)</td></tr><tr><td style="text-align:left;">WriteWalDurationNs</td><td style="text-align:left;">float</td><td style="text-align:left;">写WAL累计时延(ns)</td></tr></tbody></table><h2 id="record-内存池相关指标" tabindex="-1"><a class="header-anchor" href="#record-内存池相关指标" aria-hidden="true">#</a> record(内存池相关指标)</h2><p>openGemini内部大量使用内存池，根据作用范围可分为：</p><ul><li>AggPool</li><li>CircularRecordPool</li><li>FileCursorPool</li><li>IntervalRecordPool</li><li>SequenceAggPool</li><li>SeriesPool</li><li>TsmMergePool</li><li>TsspSequencePool</li></ul><p>每一种Pool采集Abort(累计值)/Get(累计值)/ReUse(累计值)/InUse(当前值)四类指标，分别表示对象申请内存空间过大，不再放回内存池，直接释放的次数；申请内存次数；内存复用的次数；正在使用的内存对象个数。可用于内核参数调优的依据。</p><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">AggPoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">AggPoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">AggPoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">AggPoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">CircularRecordPoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">CircularRecordPoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">CircularRecordPoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">CircularRecordPoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">FileCursorPoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">FileCursorPoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">FileCursorPoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">FileCursorPoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">IntervalRecordPoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">IntervalRecordPoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">IntervalRecordPoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">IntervalRecordPoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">SequenceAggPoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">SequenceAggPoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">SequenceAggPoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">SequenceAggPoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">SeriesPoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">SeriesPoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">SeriesPoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">SeriesPoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">TsmMergePoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">TsmMergePoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">TsmMergePoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">TsmMergePoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr><tr><td style="text-align:left;">TsspSequencePoolAbort</td><td style="text-align:left;">float</td><td style="text-align:left;">内存直接释放的次数</td></tr><tr><td style="text-align:left;">TsspSequencePoolGet</td><td style="text-align:left;">float</td><td style="text-align:left;">申请内存次数</td></tr><tr><td style="text-align:left;">TsspSequencePoolGetReUse</td><td style="text-align:left;">float</td><td style="text-align:left;">内存复用的次数</td></tr><tr><td style="text-align:left;">TsspSequencePoolInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">正在使用内存的对象个数</td></tr></tbody></table><h2 id="runtime-运行时内存指标" tabindex="-1"><a class="header-anchor" href="#runtime-运行时内存指标" aria-hidden="true">#</a> RunTime(运行时内存指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">Alloc</td><td style="text-align:left;">float</td><td style="text-align:left;">已分配但未释放的内存大小</td></tr><tr><td style="text-align:left;">CpuUsage</td><td style="text-align:left;">float</td><td style="text-align:left;">cpu利用率</td></tr><tr><td style="text-align:left;">Frees</td><td style="text-align:left;">float</td><td style="text-align:left;">累计释放堆对象的内存大小</td></tr><tr><td style="text-align:left;">HeapAlloc</td><td style="text-align:left;">float</td><td style="text-align:left;">同Alloc</td></tr><tr><td style="text-align:left;">HeapIdle</td><td style="text-align:left;">float</td><td style="text-align:left;">空闲(未使用)Span内存大小，衡量内存碎片程度</td></tr><tr><td style="text-align:left;">HeapInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">使用中的内存（最大值）</td></tr><tr><td style="text-align:left;">HeapObjects</td><td style="text-align:left;">float</td><td style="text-align:left;">累计分配的堆对象总数</td></tr><tr><td style="text-align:left;">HeapReleased</td><td style="text-align:left;">float</td><td style="text-align:left;">返还给OS的物理内存大小</td></tr><tr><td style="text-align:left;">HeapSys</td><td style="text-align:left;">float</td><td style="text-align:left;">从OS为堆申请的内存大小</td></tr><tr><td style="text-align:left;">Lookups</td><td style="text-align:left;">float</td><td style="text-align:left;">运行时执行的指针查找数</td></tr><tr><td style="text-align:left;">Mallocs</td><td style="text-align:left;">float</td><td style="text-align:left;">分配堆对象的累计数量</td></tr><tr><td style="text-align:left;">NumGC</td><td style="text-align:left;">float</td><td style="text-align:left;">完成的GC数量</td></tr><tr><td style="text-align:left;">NumGoroutine</td><td style="text-align:left;">float</td><td style="text-align:left;">产生的Goroutine数量</td></tr><tr><td style="text-align:left;">PauseTotalNs</td><td style="text-align:left;">float</td><td style="text-align:left;">从程序开始时累计暂停时长(ns)</td></tr><tr><td style="text-align:left;">Sys</td><td style="text-align:left;">float</td><td style="text-align:left;">从OS申请的内存大小</td></tr><tr><td style="text-align:left;">TotalAlloc</td><td style="text-align:left;">float</td><td style="text-align:left;">累计为对象分配的内存大小，衡量内存累计使用量</td></tr></tbody></table><h2 id="spdy-组件间连接复用相关指标" tabindex="-1"><a class="header-anchor" href="#spdy-组件间连接复用相关指标" aria-hidden="true">#</a> spdy(组件间连接复用相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">link</td><td style="text-align:left;">string</td><td style="text-align:left;">连接方向&quot;sql2meta&quot;,&quot;sql2store&quot;</td></tr><tr><td style="text-align:left;">remote_addr</td><td style="text-align:left;">string</td><td style="text-align:left;">对端IP地址</td></tr><tr><td style="text-align:left;">connTotal</td><td style="text-align:left;">float</td><td style="text-align:left;">全部连接数(内部)</td></tr><tr><td style="text-align:left;">successCreateSessionTotal</td><td style="text-align:left;">float</td><td style="text-align:left;">成功创建的连接会话数量</td></tr></tbody></table><h2 id="stream-流计算相关指标" tabindex="-1"><a class="header-anchor" href="#stream-流计算相关指标" aria-hidden="true">#</a> stream(流计算相关指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">StreamFilter</td><td style="text-align:left;">float</td><td style="text-align:left;">流式聚合中条件过滤的次数</td></tr><tr><td style="text-align:left;">StreamFilterNum</td><td style="text-align:left;">float</td><td style="text-align:left;">流式聚合中条件过滤处理的数据行数</td></tr><tr><td style="text-align:left;">StreamIn</td><td style="text-align:left;">float</td><td style="text-align:left;">流式聚合中，写管道次数</td></tr><tr><td style="text-align:left;">StreamInNum</td><td style="text-align:left;">float</td><td style="text-align:left;">流式聚合中，写入管道的总数据行数</td></tr></tbody></table><h2 id="stream-window-流式窗口聚合指标" tabindex="-1"><a class="header-anchor" href="#stream-window-流式窗口聚合指标" aria-hidden="true">#</a> Stream_window(流式窗口聚合指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">app</td><td style="text-align:left;">string</td><td style="text-align:left;">组件名</td></tr><tr><td style="text-align:left;">hostname</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">window</td><td style="text-align:left;">string</td><td style="text-align:left;">流式聚合的窗口</td></tr></tbody></table><h2 id="system-节点指标" tabindex="-1"><a class="header-anchor" href="#system-节点指标" aria-hidden="true">#</a> System(节点指标)</h2><table><thead><tr><th style="text-align:left;">指标名称</th><th style="text-align:left;">数据类型</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">host</td><td style="text-align:left;">string</td><td style="text-align:left;">组件IP地址和端口</td></tr><tr><td style="text-align:left;">AuxDiskSize</td><td style="text-align:left;">float</td><td style="text-align:left;">辅助磁盘容量，一般将WAL文件存储在不同的磁盘上，提高数据的安全性，见ts-monitor.conf aux-disk-path配置项</td></tr><tr><td style="text-align:left;">AuxDiskUsage</td><td style="text-align:left;">float</td><td style="text-align:left;">辅助磁盘空间使用率</td></tr><tr><td style="text-align:left;">AuxDiskUsed</td><td style="text-align:left;">float</td><td style="text-align:left;">辅助磁盘已使用容量</td></tr><tr><td style="text-align:left;">CpuNum</td><td style="text-align:left;">float</td><td style="text-align:left;">节点CPU核数</td></tr><tr><td style="text-align:left;">CpuUsage</td><td style="text-align:left;">float</td><td style="text-align:left;">节点CPU利用率</td></tr><tr><td style="text-align:left;">DiskSize</td><td style="text-align:left;">float</td><td style="text-align:left;">节点主磁盘容量</td></tr><tr><td style="text-align:left;">DiskUsage</td><td style="text-align:left;">float</td><td style="text-align:left;">节点主磁盘空间使用率</td></tr><tr><td style="text-align:left;">DiskUsed</td><td style="text-align:left;">float</td><td style="text-align:left;">节点主磁盘已使用磁盘容量</td></tr><tr><td style="text-align:left;">IndexUsed</td><td style="text-align:left;">float</td><td style="text-align:left;">索引数据使用磁盘容量</td></tr><tr><td style="text-align:left;">MemCacheBuff</td><td style="text-align:left;">float</td><td style="text-align:left;">内存的缓存和缓冲区大小</td></tr><tr><td style="text-align:left;">MemInUse</td><td style="text-align:left;">float</td><td style="text-align:left;">已使用的内存大小</td></tr><tr><td style="text-align:left;">MemSize</td><td style="text-align:left;">float</td><td style="text-align:left;">节点内存容量</td></tr><tr><td style="text-align:left;">MemUsage</td><td style="text-align:left;">float</td><td style="text-align:left;">节点内存使用率</td></tr><tr><td style="text-align:left;">MetaPid</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-meta的进程ID</td></tr><tr><td style="text-align:left;">MetaStatus</td><td style="text-align:left;">float</td><td style="text-align:left;">meta进程状态，1(runing) 0(killed)</td></tr><tr><td style="text-align:left;">SqlPid</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-sql的进程ID</td></tr><tr><td style="text-align:left;">SqlStatus</td><td style="text-align:left;">float</td><td style="text-align:left;">sql进程状态，1(runing) 0(killed)</td></tr><tr><td style="text-align:left;">StorePid</td><td style="text-align:left;">float</td><td style="text-align:left;">ts-store进程ID</td></tr><tr><td style="text-align:left;">StoreStatus</td><td style="text-align:left;">float</td><td style="text-align:left;">store进程状态，1(runing) 0(killed)</td></tr><tr><td style="text-align:left;">Uptime</td><td style="text-align:left;">float</td><td style="text-align:left;">节点运行时长(s)</td></tr></tbody></table>`,76),i=[s];function n(r,f){return e(),l("div",null,i)}const x=t(a,[["render",n],["__file","kernel_metrics.html.vue"]]);export{x as default};
